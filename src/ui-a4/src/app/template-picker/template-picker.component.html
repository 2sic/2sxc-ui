<div class="content">
    <md-progress-bar [ngStyle]="{ opacity: (!ready || loading) ? 1 : 0 }" [mode]="'indeterminate'"></md-progress-bar>
    <div *ngIf="ready" class="card">
        <div class="top-controls" fxLayout="row" fxLayoutAlign="center center">
            <button md-fab *ngIf="template" (click)="persistTemplate()" title="{{ 'TemplatePicker.Save' }}">
                <md-icon>check</md-icon>
            </button>
            <button md-mini-fab class="secondary" *ngIf="undoTemplateId !== null" (click)="frame.sxc.manage.contentBlock._cancelTemplateChange()"
                title="{{ 'TemplatePicker.' + (isContentApp ? 'Cancel' : 'Close') }}">
                <md-icon>close</md-icon>
            </button>
        </div>
        <md-tab-group [(selectedIndex)]="tabIndex">
            <md-tab [label]="(isContentApp ? (contentType?.Name || 'Choose a content type!') : (app?.name || 'Choose an app!'))">
                <div *ngIf="!isContentApp; else contentApp">
                    <div class="tile" [ngClass]="{ active: app?.appId === a.appId }" [attr.title]="a.name" (click)="updateApp(a)" (mouseover)="updateApp(a, true)"
                        (mouseout)="reloadApp()" *ngFor="let a of apps">
                        {{ a.name }}
                    </div>
                    <div class="tile config" *ngIf="showAdvanced && !isContentApp" (click)="frame.sxc.manage.run('app-import')">
                        Install Apps
                    </div>
                    <div class="tile config" *ngIf="showAdvanced && !isContentApp" (click)="frame.sxc.manage.run('zone')">
                        Manage Apps
                    </div>
                </div>
                <ng-template #contentApp>
                    <div class="tile" [ngClass]="{ active: contentType?.StaticName === c.StaticName }" [attr.title]="c.Label" (mouseover)="updateContentType(c, true)"
                        (mouseout)="reloadContentType()" (click)="updateContentType(c)" *ngFor="let c of contentTypes">
                        {{ c.Label }}
                    </div>
                </ng-template>
            </md-tab>
            <md-tab *ngIf="isContentApp ? contentType : app" [label]="'Change View'">
                <div class="no-template-msg" *ngIf="templates.length === 0">No template</div>
                <div class="tile" [ngClass]="{ active: template?.TemplateId === t.TemplateId }" [attr.title]="t.name" (click)="updateTemplateSubject.next({ template: t })"
                    *ngFor="let t of templates">
                    {{ t.Name }}
                </div>
                <div class="tile config" *ngIf="showAdvanced && !isContentApp && app?.appId !== null" (click)="frame.sxc.manage.run('app')">
                    Manage Views
                </div>
            </md-tab>
        </md-tab-group>
        <app-installer *ngIf="showInstaller" [isContentApp]="isContentApp"></app-installer>
    </div>
</div>