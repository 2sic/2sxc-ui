{"version":3,"sources":["2sxc.api.min.js"],"names":["window","$2sxc","id","cbid","autoFind","cacheKey","_controllers","_data","controller","serviceScopes","serviceRoot","$","ServicesFramework","getServiceRoot","resolveServiceUrl","virtualPath","scope","split","toLowerCase","indexOf","substring","data","sourceUrl","params","url","in","List","load","source","setData","origSuccess","success","dataSetName","hasOwnProperty","name","Default","isLoaded","lastRefresh","Date","_triggerLoaded","error","request","alert","statusText","preventAutoFail","reload","webApi","get","then","on","events","callback","bind","trigger","one","manage","isEditMode","_isEditMode","recreate","s","p","d","paf","_action","post","delete","put","settings","method","controllerAction","controllerName","actionName","action","length","defaults","extend","sf","promise","ajax","type","dataType","async","JSON","stringify","contentType","getActionUrl","beforeSend","xhr","setRequestHeader","setModuleHeaders","fail","showDetailedHttpError","base","param","result","console","log","status","config","infoText","srvResp","responseText","parse","msg","Message","msgDet","MessageDetail","ExceptionMessage","_manage","attach","e","_translateInit","sysinfo","version","description","beta","totalPopup","open","z","top","parent","wrapper","document","createElement","setAttribute","body","appendChild","ifrm","className","frame","close","replace","frm","parentNode","removeChild","closeThis","urlParams","searchRx","RegExp","results","exec","location","search","hashRx","hash","matches","pathname","match","reverse","undefined","decodeURIComponent","require","found","message","domElement","containerTag","closest","iid","getAttribute","debug","uncache","parts","getUrl","preventUnmin","r"],"mappings":"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","file":"2sxc.api.min.js","sourcesContent":["// this is the 2sxc-javascript API\n// 2sxc will include this automatically when a user has edit-rights\n// a template developer will typically use this to use the data-api to read 2sxc-data from the server\n// read more about this in the wiki: https://github.com/2sic/2sxc/wiki/JavaScript-%242sxc\n(function () {\n    if (window.$2sxc) return;   // prevent double execution\n\n    window.$2sxc = function (id, cbid) {\n\n        // if it's a dom-element, use auto-find\n        if (typeof id === 'object') return window.$2sxc.autoFind(id);\n\n        if (!cbid) cbid = id;           // if content-block is unknown, use id of module\n        var cacheKey = id + \":\" + cbid; // neutralize the id from old \"34\" format to the new \"35:353\" format\n\n        // either get the cached controller from previous calls, or create a new one\n        if ($2sxc._controllers[cacheKey]) return $2sxc._controllers[cacheKey];\n\n        // also init the data-cache in case it's ever needed\n        if (!$2sxc._data[cacheKey]) $2sxc._data[cacheKey] = {};\n\n        var controller = $2sxc._controllers[cacheKey] = {\n            serviceScopes: [\"app\", \"app-sys\", \"app-api\", \"app-query\", \"app-content\", \"eav\", \"view\", \"dnn\"],\n            serviceRoot: $.ServicesFramework(id).getServiceRoot(\"2sxc\"),\n            resolveServiceUrl: function resolveServiceUrl(virtualPath) {\n                var scope = virtualPath.split(\"/\")[0].toLowerCase();\n\n                // stop if it's not one of our special paths\n                if (controller.serviceScopes.indexOf(scope) === -1)\n                    return virtualPath;\n\n                return controller.serviceRoot + scope + \"/\" + virtualPath.substring(virtualPath.indexOf(\"/\") + 1);\n            },\n            data: {\n                // source path defaulting to current page + optional params\n                sourceUrl: function (params) {\n                    var url = controller.resolveServiceUrl(\"app-sys/appcontent/GetContentBlockData\");\n                    if (typeof params == \"string\") // text like 'id=7'\n                        url += \"&\" + params;\n                    return url;\n                },\n\n                // in-streams\n                \"in\": {},\n\n                // Will hold the default stream ([\"in\"][\"Default\"].List\n                List: [],\n\n                controller: null,\n\n                // Load data via ajax\n                load: function (source) {\n                    // If source is already the data, set it\n                    if (source && source.List) {\n                        controller.data.setData(source);\n                        return controller.data;\n                    } else {\n                        if (!source)\n                            source = {};\n                        if (!source.url)\n                            source.url = controller.data.sourceUrl();\n                        source.origSuccess = source.success;\n                        source.success = function (data) {\n\n                            for (var dataSetName in data) {\n                                if (data.hasOwnProperty(dataSetName))\n                                    if (data[dataSetName].List !== null) {\n                                        controller.data[\"in\"][dataSetName] = data[dataSetName];\n                                        controller.data[\"in\"][dataSetName].name = dataSetName;\n                                    }\n                            }\n\n                            if (controller.data[\"in\"].Default)\n                                controller.List = controller.data[\"in\"].Default.List;\n\n                            if (source.origSuccess)\n                                source.origSuccess(controller.data);\n\n                            controller.isLoaded = true;\n                            controller.lastRefresh = new Date();\n                            controller.data._triggerLoaded();\n                        };\n                        source.error = function (request) { alert(request.statusText); };\n                        source.preventAutoFail = true; // use our fail message\n                        controller.data.source = source;\n                        return controller.data.reload();\n                    }\n                },\n\n                reload: function () {\n                    controller.webApi.get(controller.data.source)\n                        .then(controller.data.source.success, controller.data.source.error);\n                    return controller.data;\n\n                },\n\n                on: function (events, callback) {\n                    return $(controller.data).bind(\"2scLoad\", callback)[0]._triggerLoaded();\n                },\n\n                _triggerLoaded: function () {\n                    return controller.isLoaded ? $(controller.data).trigger(\"2scLoad\", [controller.data])[0] : controller.data;\n                },\n\n                one: function (events, callback) {\n                    if (!controller.isLoaded)\n                        return $(controller.data).one(\"2scLoad\", callback)[0];\n                    callback({}, controller.data);\n                    return controller.data;\n                }\n            },\n\n            id: id,\n            cbid: cbid,\n            cacheKey: cacheKey,\n            source: null,\n            isLoaded: false,\n            lastRefresh: null,\n            manage: null, // initialize correctly later on\n            isEditMode: function () {\n                return controller.manage && controller.manage._isEditMode();\n            },\n            recreate: function () {\n                delete $2sxc._controllers[cacheKey];    // clear cache\n                return $2sxc(controller.id, controller.cbid);   // generate new\n            },\n            webApi: {\n                get: function (s, p, d, paf) { return controller.webApi._action(s, p, d, paf, \"GET\"); },\n                post: function (s, p, d, paf) { return controller.webApi._action(s, p, d, paf, \"POST\"); },\n                \"delete\": function (s, p, d, paf) { return controller.webApi._action(s, p, d, paf, \"DELETE\"); },\n                put: function (s, p, d, paf) { return controller.webApi._action(s, p, d, paf, \"PUT\"); },\n                _action: function (settings, params, data, preventAutoFail, method) {\n\n                    // Url parameter: autoconvert a single value (instead of object of values) to an id=... parameter\n                    if (typeof params != \"object\" && typeof params != \"undefined\")\n                        params = { id: params };\n\n                    // If the first parameter is a string, resolve settings\n                    if (typeof settings == \"string\") {\n                        var controllerAction = settings.split(\"/\");\n                        var controllerName = controllerAction[0];\n                        var actionName = controllerAction[1];\n\n                        if (controllerName === \"\" || actionName === \"\")\n                            alert(\"Error: controller or action not defined. Will continue with likely errors.\");\n\n                        settings = {\n                            controller: controllerName,\n                            action: actionName,\n                            params: params,\n                            data: data,\n                            url: controllerAction.length > 2 ? settings : null,\n                            preventAutoFail: preventAutoFail\n                        };\n                    }\n\n                    var defaults = {\n                        method: method === null ? \"POST\" : method,\n                        params: null,\n                        preventAutoFail: false\n                    };\n                    settings = $.extend({}, defaults, settings);\n                    var sf = $.ServicesFramework(id);\n\n                    var promise = $.ajax({\n                        type: settings.method,\n                        dataType: settings.dataType || \"json\", // default is json if not specified\n                        async: true,\n                        data: JSON.stringify(settings.data),\n                        contentType: \"application/json\",\n                        url: controller.webApi.getActionUrl(settings),\n                        beforeSend: function (xhr) {\n                            xhr.setRequestHeader(\"ContentBlockId\", cbid);\n                            sf.setModuleHeaders(xhr);\n                        }\n                    });\n\n                    if (!settings.preventAutoFail)\n                        promise.fail(controller.showDetailedHttpError);\n\n                    return promise;\n                },\n                getActionUrl: function (settings) {\n                    var sf = $.ServicesFramework(id);\n                    var base = (settings.url)\n                        ? controller.resolveServiceUrl(settings.url)\n                        : sf.getServiceRoot(\"2sxc\") + \"app/auto/api/\" + settings.controller + \"/\" + settings.action;\n                    return base + (settings.params === null ? \"\" : (\"?\" + $.param(settings.params)));\n                }\n            },\n\n            // Show a nice error with more infos around 2sxc\n            showDetailedHttpError: function showDetailedHttpError(result) {\n                if (window.console)\n                    console.log(result);\n\n                if (result.status === 404 && result.config && result.config.url && result.config.url.indexOf(\"/dist/i18n/\") > -1) {\n                    if (window.console)\n                        console.log(\"just fyi: failed to load language resource; will have to use default\");\n                    return result;\n                }\n\n\n                // if it's an unspecified 0-error, it's probably not an error but a cancelled request, (happens when closing popups containing angularJS)\n                if (result.status === 0 || result.status === -1)\n                    return result;\n\n                // let's try to show good messages in most cases\n                var infoText = \"Had an error talking to the server (status \" + result.status + \").\";\n                var srvResp = result.responseText ?\n                    JSON.parse(result.responseText) // for jquery ajax errors\n                    : result.data;                  // for angular $http\n                if (srvResp) {\n                    var msg = srvResp.Message;\n                    if (msg) infoText += \"\\nMessage: \" + msg;\n                    var msgDet = srvResp.MessageDetail || srvResp.ExceptionMessage;\n                    if (msgDet) infoText += \"\\nDetail: \" + msgDet;\n\n\n                    if (msgDet && msgDet.indexOf(\"No action was found\") === 0)\n                        if (msgDet.indexOf(\"that matches the name\") > 0)\n                            infoText += \"\\n\\nTip from 2sxc: you probably got the action-name wrong in your JS.\";\n                        else if (msgDet.indexOf(\"that matches the request.\") > 0)\n                            infoText += \"\\n\\nTip from 2sxc: Seems like the parameters are the wrong amount or type.\";\n\n                    if (msg && msg.indexOf(\"Controller\") === 0 && msg.indexOf(\"not found\") > 0)\n                        infoText += \"\\n\\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word 'controller' from the call in JS. To call a controller called 'DemoController' only use 'Demo'.\";\n\n                }\n                infoText += \"\\n\\nif you are an advanced user you can learn more about what went wrong - discover how on 2sxc.org/help?tag=debug\";\n                alert(infoText);\n\n                return result;\n            }\n        };\n\n        // add manage property, but not within initializer, because inside the manage-initializer it may reference 2sxc again\n        try { // sometimes the manage can't be built, like before installing\n            controller.manage = null;\n            if ($2sxc._manage) $2sxc._manage.attach(controller);\n        } catch (e) {\n            throw e;\n        }\n\n        // this only works when manage exists (not installing) and translator exists too\n        if ($2sxc._translateInit && controller.manage) $2sxc._translateInit(controller.manage);    // init translate, not really nice, but ok for now\n\n        // Make sure back-reference to controller is set\n        controller.data.controller = controller;\n\n        return controller;\n    };\n\n    $2sxc._controllers = {};\n    $2sxc.sysinfo = {\n        version: \"09.03.00\",\n        description: \"The 2sxc Controller object\"\n    };\n\n    $2sxc.beta = {};\n    $2sxc._data = {};\n\n\n    // this creates a full-screen iframe-popup and provides a close-command to finish the dialog as needed\n    $2sxc.totalPopup = {\n        open: function openTotalPopup(url, callback) {\n            // count parents to see how high the z-index needs to be\n            var z = 10000010, p = window; // Needs at least 10000000 to be on top of the DNN9 bar\n            while (p !== window.top && z < 10000100) {\n                z++;\n                p = p.parent;\n            }\n\n            var wrapper = document.createElement(\"div\");\n            wrapper.setAttribute(\"style\", \" top: 0;left: 0;width: 100%;height: 100%; position:fixed; z-index:\" + z);\n            document.body.appendChild(wrapper);\n\n            var ifrm = document.createElement(\"iframe\");\n            ifrm.setAttribute(\"allowtransparency\", \"true\");\n            ifrm.setAttribute(\"style\", \"top: 0;left: 0;width: 100%;height: 100%;\");\n            ifrm.setAttribute(\"src\", url);\n            wrapper.appendChild(ifrm);\n            document.body.className += \" sxc-popup-open\";\n            $2sxc.totalPopup.frame = ifrm;\n            $2sxc.totalPopup.callback = callback;\n        },\n        close: function closeTotalPopup() {\n            if ($2sxc.totalPopup.frame) {\n                document.body.className = document.body.className.replace(\"sxc-popup-open\", \"\");\n                var frm = $2sxc.totalPopup.frame;\n                frm.parentNode.parentNode.removeChild(frm.parentNode);\n                $2sxc.totalPopup.callback();\n            }\n        },\n        closeThis: function closeThis() {\n            window.parent.$2sxc.totalPopup.close();\n        }\n    };\n\n    $2sxc.urlParams = {\n        get: function getParameterByName(name) {\n            // warning: this method is duplicated in 2 places - keep them in sync. \n            // locations are eav and 2sxc4ng \n            name = name.replace(/[\\[]/, \"\\\\[\").replace(/[\\]]/, \"\\\\]\");\n            var searchRx = new RegExp(\"[\\\\?&]\" + name + \"=([^&#]*)\", \"i\");\n            var results = searchRx.exec(location.search);\n\n            if (results === null) {\n                var hashRx = new RegExp(\"[#&]\" + name + \"=([^&#]*)\", \"i\");\n                results = hashRx.exec(location.hash);\n            }\n\n            // if nothing found, try normal URL because DNN places parameters in /key/value notation\n            if (results === null) {\n                // Otherwise try parts of the URL\n                var matches = window.location.pathname.match(new RegExp(\"/\" + name + \"/([^/]+)\", \"i\"));\n\n                // Check if we found anything, if we do find it, we must reverse the results so we get the \"last\" one in case there are multiple hits\n                if (matches && matches.length > 1)\n                    results = matches.reverse()[0];\n            } else\n                results = results[1];\n\n            return results === null || results === undefined ? \"\" : decodeURIComponent(results.replace(/\\+/g, \" \"));\n        },\n\n        require: function getRequiredParameter(name) {\n            var found = $2sxc.urlParams.get(name);\n            if (found === \"\") {\n                var message = \"Required parameter (\" + name + \") missing from url - cannot continue\";\n                alert(message);\n                throw message;\n            }\n            return found;\n        }\n    };\n\n    // will find the controller based on the dom-element\n    $2sxc.autoFind = function (domElement) {\n        var containerTag = $(domElement).closest(\".sc-content-block\")[0];\n        if (!containerTag) return null;\n        var iid = containerTag.getAttribute(\"data-cb-instance\"), cbid = containerTag.getAttribute(\"data-cb-id\");\n        if (!iid || !cbid) return null;\n        return $2sxc(iid, cbid);\n    };\n\n    // note: I would like to remove this from $2sxc, but it's currently used both in the inpage-edit and in the dialogs\n    // debug state which is needed in various places\n    $2sxc.debug = {\n        load: ($2sxc.urlParams.get(\"debug\") === \"true\"),\n        uncache: $2sxc.urlParams.get(\"sxcver\")\n    };\n\n\n    // mini-helpers to manage 2sxc parts, a bit like a dependency loader which will optimize to load min/max depending on debug state\n    $2sxc.parts = {\n        getUrl: function improveUrl(url, preventUnmin) {\n            var r = (preventUnmin || !$2sxc.debug.load) ? url : url.replace(\".min\", \"\"); // use min or not\n            if ($2sxc.debug.uncache && r.indexOf(\"sxcver\") === -1)\n                r = r + ((r.indexOf(\"?\") === -1) ? \"?\" : \"&\") + \"sxcver=\" + $2sxc.debug.uncache;\n            return r;\n        }\n    };\n})();"],"sourceRoot":"/source/"}