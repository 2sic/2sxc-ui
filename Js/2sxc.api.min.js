!function(){function e(e,r){if("object"==typeof e)return t(e);r||(r=e);var o=e+":"+r;if(a._controllers[o])return a._controllers[o];a._data[o]||(a._data[o]={});var n=a._controllers[o]={serviceScopes:["app","app-sys","app-api","app-query","app-content","eav","view","dnn"],serviceRoot:$.ServicesFramework(e).getServiceRoot("2sxc"),resolveServiceUrl:function(e){var t=e.split("/")[0].toLowerCase();return-1===n.serviceScopes.indexOf(t)?e:n.serviceRoot+t+"/"+e.substring(e.indexOf("/")+1)},data:{sourceUrl:function(e){var t=n.resolveServiceUrl("app-sys/appcontent/GetContentBlockData");return"string"==typeof e&&(t+="&"+e),t},source:void 0,"in":{},List:[],load:function(e){return e&&e.List?n.data:(e||(e={}),e.url||(e.url=n.data.sourceUrl()),e.origSuccess=e.success,e.success=function(t){for(var a in t)t.hasOwnProperty(a)&&null!==t[a].List&&(n.data["in"][a]=t[a],n.data["in"][a].name=a);n.data["in"].Default&&(n.data.List=n.data["in"].Default.List),e.origSuccess&&e.origSuccess(n.data),n.isLoaded=!0,n.lastRefresh=new Date,n.data._triggerLoaded()},e.error=function(e){alert(e.statusText)},e.preventAutoFail=!0,n.data.source=e,n.data.reload())},reload:function(){return n.webApi.get(n.data.source).then(n.data.source.success,n.data.source.error),n.data},on:function(e,t){return $(n.data).bind("2scLoad",t)[0]._triggerLoaded()},_triggerLoaded:function(){return n.isLoaded?$(n.data).trigger("2scLoad",[n.data])[0]:n.data},one:function(e,t){return n.isLoaded?(t({},n.data),n.data):$(n.data).one("2scLoad",t)[0]}},id:e,cbid:r,cacheKey:o,source:null,isLoaded:!1,lastRefresh:null,manage:null,isEditMode:function(){return n.manage&&n.manage._isEditMode()},recreate:function(e){return e&&delete a._controllers[o],a(n.id,n.cbid)},webApi:{get:function(e,t,a,r){return n.webApi._action(e,t,a,r,"GET")},post:function(e,t,a,r){return n.webApi._action(e,t,a,r,"POST")},"delete":function(e,t,a,r){return n.webApi._action(e,t,a,r,"DELETE")},put:function(e,t,a,r){return n.webApi._action(e,t,a,r,"PUT")},_action:function(t,a,o,i,c){if("object"!=typeof a&&"undefined"!=typeof a&&(a={id:a}),"string"==typeof t){var s=t.split("/"),l=s[0],u=s[1];""!==l&&""!==u||alert("Error: controller or action not defined. Will continue with likely errors."),t={controller:l,action:u,params:a,data:o,url:s.length>2?t:null,preventAutoFail:i}}var d={method:null===c?"POST":c,params:null,preventAutoFail:!1};t=$.extend({},d,t);var p=$.ServicesFramework(e),f=$.ajax({type:t.method,dataType:t.dataType||"json",async:!0,data:JSON.stringify(t.data),contentType:"application/json",url:n.webApi.getActionUrl(t),beforeSend:function(e){e.setRequestHeader("ContentBlockId",r),p.setModuleHeaders(e)}});return t.preventAutoFail||f.fail(n.showDetailedHttpError),f},getActionUrl:function(t){var a=$.ServicesFramework(e),r=t.url?n.resolveServiceUrl(t.url):a.getServiceRoot("2sxc")+"app/auto/api/"+t.controller+"/"+t.action;return r+(null===t.params?"":"?"+$.param(t.params))}},showDetailedHttpError:function(e){if(window.console&&console.log(e),404===e.status&&e.config&&e.config.url&&e.config.url.indexOf("/dist/i18n/")>-1)return window.console&&console.log("just fyi: failed to load language resource; will have to use default"),e;if(0===e.status||-1===e.status)return e;var t="Had an error talking to the server (status "+e.status+").",a=e.responseText?JSON.parse(e.responseText):e.data;if(a){var r=a.Message;r&&(t+="\nMessage: "+r);var o=a.MessageDetail||a.ExceptionMessage;o&&(t+="\nDetail: "+o),o&&0===o.indexOf("No action was found")&&(o.indexOf("that matches the name")>0?t+="\n\nTip from 2sxc: you probably got the action-name wrong in your JS.":o.indexOf("that matches the request.")>0&&(t+="\n\nTip from 2sxc: Seems like the parameters are the wrong amount or type.")),r&&0===r.indexOf("Controller")&&r.indexOf("not found")>0&&(t+="\n\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word 'controller' from the call in JS. To call a controller called 'DemoController' only use 'Demo'.")}return t+="\n\nif you are an advanced user you can learn more about what went wrong - discover how on 2sxc.org/help?tag=debug",alert(t),e}};try{n.manage=null,a._manage&&a._manage.initInstance(n)}catch(i){throw i}return a._translateInit&&n.manage&&a._translateInit(n.manage),n}function t(e){var t=$(e).closest(".sc-content-block")[0];if(!t)return null;var r=t.getAttribute("data-cb-instance"),o=t.getAttribute("data-cb-id");return r&&o?a(r,o):null}if(!window.$2sxc){var a=window.$2sxc=e;a._controllers={},a.sysinfo={version:"09.05.00",description:"The 2sxc Controller object - read more about it on 2sxc.org"},a.beta={},a._data={},a.totalPopup={open:function(e,t){for(var r=10000010,o=window;o!==window.top&&10000100>r;)r++,o=o.parent;var n=document.createElement("div");n.setAttribute("style"," top: 0;left: 0;width: 100%;height: 100%; position:fixed; z-index:"+r),document.body.appendChild(n);var i=document.createElement("iframe");i.setAttribute("allowtransparency","true"),i.setAttribute("style","top: 0;left: 0;width: 100%;height: 100%;"),i.setAttribute("src",e),n.appendChild(i),document.body.className+=" sxc-popup-open",a.totalPopup.frame=i,a.totalPopup.callback=t},close:function(){if(a.totalPopup.frame){document.body.className=document.body.className.replace("sxc-popup-open","");var e=a.totalPopup.frame;e.parentNode.parentNode.removeChild(e.parentNode),a.totalPopup.callback()}},closeThis:function(){window.parent.$2sxc.totalPopup.close()},frame:void 0,callback:void 0},a.urlParams={get:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t,a=new RegExp("[\\?&]"+e+"=([^&#]*)","i"),r=a.exec(location.search);if(null===r){var o=new RegExp("[#&]"+e+"=([^&#]*)","i");r=o.exec(location.hash)}if(null===r){var n=window.location.pathname.match(new RegExp("/"+e+"/([^/]+)","i"));n&&n.length>1&&(t=n.reverse()[0])}else t=r[1];return null===t||void 0===t?"":decodeURIComponent(t.replace(/\+/g," "))},require:function(e){var t=a.urlParams.get(e);if(""===t){var r="Required parameter ("+e+") missing from url - cannot continue";throw alert(r),r}return t}},a.debug={load:"true"===a.urlParams.get("debug"),uncache:a.urlParams.get("sxcver")},a.parts={getUrl:function(e,t){var r=t||!a.debug.load?e:e.replace(".min","");return a.debug.uncache&&-1===r.indexOf("sxcver")&&(r=r+(-1===r.indexOf("?")?"?":"&")+"sxcver="+a.debug.uncache),r}}}}();
//# sourceMappingURL=2sxc.api.min.js.map
