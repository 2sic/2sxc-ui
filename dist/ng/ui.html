<!doctype html>
<html>

<head>
  <script>
    var
      path = window.location.pathname,
      isDevMode = window.location.hostname === 'localhost',
      apiUrl;

    document.write('<base href="' + path + '">');

    var
      jsVersionCacheId = window.location.search,
      devPath = 'http://2sxc.dev/desktopmodules/tosic_sexycontent/dist/a4/';
    document.write('<script src="' + (isDevMode ? devPath : '') + '../../js/2sxc.api.js' + jsVersionCacheId + '"></scr' + 'ipt>');
    // must now close the script tag, so that the added tag is parsed before all other code
  </script>
  <script>
    apiUrl = $2sxc.urlParams.require("portalroot") + "desktopmodules/2sxc/api/";
    createFakeSf(apiUrl);

    // Create a fake DNN Service-Framework, required by $2sxc to work properly
    function createFakeSf(apiUrl) {
      if ($2sxc.urlParams.require("mid") === "") alert("ModuleId (mid) missing - cannot continue"); if (window.$ === undefined) window.$ = {};
      window.$.ServicesFramework = function (id) {
        return {
          name: "This is a fake DNN ServicesFramework", description:
          "It enables stuff requiring (but not really needing) the sf to work", getTabId: function () {
            return $2sxc.urlParams.require("tid");
          }, getAntiForgeryValue: function () {
            return "abcdefgihjklmnop";
          }, getServiceRoot: function () {
            return apiUrl;
          }
        }
      };
    };

    // add a script right then and there to the document, correctly cache-busting 
    function addScript(src) {
      var async = src.async || false;
      src = typeof src === "string" ? src : src.url;
      var script = document.createElement('script');
      script.src = src + jsVersionCacheId;
      if (async)
        document.getElementsByTagName("head")[0].appendChild(script);
      else
        document.write(script.outerHTML); // needs doc.write to ensure in-sync loading of the files
    }

    function addStyle(src) {
      var style = document.createElement("link");
      style.setAttribute("rel", "stylesheet");
      style.setAttribute("type", "text/css");
      style.setAttribute("href", src);// + "?" + sxcVersionParam);
      document.getElementsByTagName("head")[0].appendChild(style);
    }

    var scripts = [
      'inline.bundle.js',     // ? purpose unknown yet    
      // todo: i18n probably...
      // '../i18n/lib/angular-i18n/angular-locale_' + langTwoLetter + '.js',
      'polyfills.bundle.js',  // js polyfills for older browsers
      'vendor.bundle.js',     // default set needed for all UIs like angular, animate, translate
      'main.bundle.js',        // our app, with everything
      'styles.bundle.js'
    ], styles = [
      'styles.bundle.css'
    ];
  </script>
  <meta charset="utf-8">
  <title>Quick Dialog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link href="//fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

<body>
  <app-root></app-root>
  <script>
    if (!isDevMode) {
      var s;
      // now add the scripts as needed
      for (s = 0; s < scripts.length; s++) addScript(scripts[s]);
      for (s = 0; s < styles.length; s++) addStyle(styles[s]);
    }
  </script>
</body>

</html>